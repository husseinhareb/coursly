{# templates/courses/courses.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}My Courses{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/course.css') }}">
{% endblock %}

{% block body %}
<div class="course-page">
    <!-- Header container with page title and Add Course button -->
    <div class="course-header-container">
        <h1 class="page-title">My Courses</h1>
        <a href="{{ path('courses_new') }}" class="btn-add-course">Add Course</a>
    </div>

    <!-- Search bar -->
    <div class="search-bar">
        <input type="text" id="search" class="search-input" placeholder="Search for a course...">
    </div>

    <!-- Grid of course cards -->
    <div class="course-grid">
        {% for course in courses %}
            {% set color = colors[loop.index0 % colors|length] %}
            <div class="course-card">
                <div class="course-header" style="background-color: {{ color }};"></div>
                <div class="course-content">
                    <h5 class="course-title">
                        <a href="{{ path('courses_show', { id: course.id, code: course.code }) }}">
                            {{ course.title }}
                        </a>
                    </h5>
                    <p class="course-subtitle">{{ course.code }}</p>
                    {# Edit button for each course #}
                        <a href="{{ path('courses_edit', { id: course.id }) }}" class="btn-edit">Edit</a>
                </div>
            </div>
        {% else %}
            <p class="no-courses-message">No courses available.</p>
        {% endfor %}
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    let searchInput = document.getElementById("search");

    searchInput.addEventListener("input", function () {
        let query = this.value.toLowerCase().trim();
        let cards = document.querySelectorAll(".course-card");

        cards.forEach(card => {
            let title = card.querySelector(".course-title").innerText.toLowerCase();
            card.style.display = title.includes(query) ? "block" : "none";
        });
    });
});
</script>
{% endblock %}
