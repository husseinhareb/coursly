{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/home.css') }}">
{% endblock %}

{% block body %}
<header class="header">
    <div class="header-content">
        <a class="site-logo" href="{{ path('app_home') }}">Mooooooooooodle</a>
        <button class="menu-toggle" aria-label="Toggle navigation">
            <span class="toggle-bar"></span>
            <span class="toggle-bar"></span>
            <span class="toggle-bar"></span>
        </button>
        <nav class="main-nav">
            <ul class="menu">
                {% if app.user %}
                    <li class="menu-item profile-section">
                        {% if app.user.profilePic %}
                            <img src="{{ asset('uploads/profile_pics/' ~ app.user.profilePic) }}" 
                                 alt="Profile Picture" class="profile-pic">
                        {% else %}
                            <div class="profile-pic avatar-initials">
                                {{ app.user.userIdentifier|first|upper }}
                            </div>
                        {% endif %}
                        <span class="user-info">Logged in as {{ app.user.userIdentifier }}</span>
                        <span class="user-role">Role: {{ app.user.roles|join(', ') }}</span>
                    </li>
                    <li class="menu-item">
                        <a class="menu-link" href="{{ path('app_logout') }}">Logout</a>
                    </li>
                    {% if 'ROLE_ADMIN' in app.user.roles %}
                        <li class="menu-item">
                            <a class="menu-link" href="{{ path('app_register') }}"> Add user </a>
                        </li>
                    {% endif %}
                {% else %}
                    <li class="menu-item">
                        <a class="menu-link" href="{{ path('app_login') }}">Login</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>
</header>

<main class="main-content">
    {% if app.user %}
        <h1 class="welcome-heading">Hello, {{ app.user.firstName }}!</h1>
        <p class="user-detail">Your email: {{ app.user.userIdentifier }}</p>
        <p class="user-detail">Your role: {{ app.user.roles|join(', ') }}</p>
    {% else %}
        <h1 class="welcome-heading">Welcome to the homepage!</h1>
        <p class="login-prompt">Please log in to see your account details.</p>
    {% endif %}
</main>

<script>
    document.querySelector('.menu-toggle').addEventListener('click', function() {
        document.querySelector('.main-nav').classList.toggle('active');
    });
</script>
{% endblock %}
